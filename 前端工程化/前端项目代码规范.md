# å‰ç«¯é¡¹ç›®ä»£ç è§„èŒƒçš„æ­å»º

> Eslint + Prettier + Husky + Commitlint ä½¿ç”¨æŒ‡å—

[TOC]



## å†™åœ¨å‰é¢

è¿™é‡Œæ˜¯å°é£ä¾ PanğŸ¥³ï¼Œç«‹å¿—æˆä¸ºä¸€åä¼˜ç§€çš„å‰ç«¯ç¨‹åºåª›ï¼ï¼ï¼

æœ¬ç¯‡åšå®¢æ”¶å½•äºæˆ‘çš„[github](https://github.com/mengqiuleo)å‰ç«¯ç¬”è®°ä»“åº“ä¸­ï¼ŒæŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿star~

ğŸ‘‰[https://github.com/mengqiuleo/myNote](https://github.com/mengqiuleo/myNote)





## 1.1. é›†æˆeditorconfigé…ç½®

EditorConfig æœ‰åŠ©äºä¸ºä¸åŒ IDE ç¼–è¾‘å™¨ä¸Šå¤„ç†åŒä¸€é¡¹ç›®çš„å¤šä¸ªå¼€å‘äººå‘˜ç»´æŠ¤ä¸€è‡´çš„ç¼–ç é£æ ¼ã€‚

ä¸‹é¢çš„ä»£ç æ”¾åˆ° .editorconfig æ–‡ä»¶ä¸­

```yaml
# http://editorconfig.org

root = true

[*] # è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶é€‚ç”¨
charset = utf-8 # è®¾ç½®æ–‡ä»¶å­—ç¬¦é›†ä¸º utf-8
indent_style = space # ç¼©è¿›é£æ ¼ï¼ˆtab | spaceï¼‰
indent_size = 2 # ç¼©è¿›å¤§å°
end_of_line = lf # æ§åˆ¶æ¢è¡Œç±»å‹(lf | cr | crlf)
trim_trailing_whitespace = true # å»é™¤è¡Œé¦–çš„ä»»æ„ç©ºç™½å­—ç¬¦
insert_final_newline = true # å§‹ç»ˆåœ¨æ–‡ä»¶æœ«å°¾æ’å…¥ä¸€ä¸ªæ–°è¡Œ

[*.md] # è¡¨ç¤ºä»… md æ–‡ä»¶é€‚ç”¨ä»¥ä¸‹è§„åˆ™
max_line_length = off
trim_trailing_whitespace = false
```



VSCodeéœ€è¦å®‰è£…ä¸€ä¸ªæ’ä»¶ï¼šEditorConfig for VS Code

![image-20210722215138665](https://tva1.sinaimg.cn/large/008i3skNgy1gsq2gh989yj30pj05ggmb.jpg)





## 1.2. ä½¿ç”¨prettierå·¥å…·

Prettier æ˜¯ä¸€æ¬¾å¼ºå¤§çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æŒ JavaScriptã€TypeScriptã€CSSã€SCSSã€Lessã€JSXã€Angularã€Vueã€GraphQLã€JSONã€Markdown ç­‰è¯­è¨€ï¼ŒåŸºæœ¬ä¸Šå‰ç«¯èƒ½ç”¨åˆ°çš„æ–‡ä»¶æ ¼å¼å®ƒéƒ½å¯ä»¥æå®šï¼Œæ˜¯å½“ä¸‹æœ€æµè¡Œçš„ä»£ç æ ¼å¼åŒ–å·¥å…·ã€‚

1.å®‰è£…prettier

```shell
npm install prettier -D
```

2.é…ç½®.prettierrcæ–‡ä»¶ï¼š

* useTabsï¼šä½¿ç”¨tabç¼©è¿›è¿˜æ˜¯ç©ºæ ¼ç¼©è¿›ï¼Œé€‰æ‹©falseï¼›
* tabWidthï¼štabæ˜¯ç©ºæ ¼çš„æƒ…å†µä¸‹ï¼Œæ˜¯å‡ ä¸ªç©ºæ ¼ï¼Œé€‰æ‹©2ä¸ªï¼›
* printWidthï¼šå½“è¡Œå­—ç¬¦çš„é•¿åº¦ï¼Œæ¨è80ï¼Œä¹Ÿæœ‰äººå–œæ¬¢100æˆ–è€…120ï¼›
* singleQuoteï¼šä½¿ç”¨å•å¼•å·è¿˜æ˜¯åŒå¼•å·ï¼Œé€‰æ‹©trueï¼Œä½¿ç”¨å•å¼•å·ï¼›
* trailingCommaï¼šåœ¨å¤šè¡Œè¾“å…¥çš„å°¾é€—å·æ˜¯å¦æ·»åŠ ï¼Œè®¾ç½®ä¸º `none`ï¼›
* semiï¼šè¯­å¥æœ«å°¾æ˜¯å¦è¦åŠ åˆ†å·ï¼Œé»˜è®¤å€¼trueï¼Œé€‰æ‹©falseè¡¨ç¤ºä¸åŠ ï¼›

```json
{
  "useTabs": false,
  "tabWidth": 2,
  "printWidth": 80,
  "singleQuote": true,
  "trailingComma": "none",
  "semi": false
}
```



3.åˆ›å»º.prettierignoreå¿½ç•¥æ–‡ä»¶

```
/dist/*
.local
.output.js
/node_modules/**

**/*.svg
**/*.sh

/public/*
```



4.VSCodeéœ€è¦å®‰è£…prettierçš„æ’ä»¶

![image-20210722214543454](https://tva1.sinaimg.cn/large/008i3skNgy1gsq2acx21rj30ow057mxp.jpg)

5.æµ‹è¯•prettieræ˜¯å¦ç”Ÿæ•ˆ

* æµ‹è¯•ä¸€ï¼šåœ¨ä»£ç ä¸­ä¿å­˜ä»£ç ï¼›
* æµ‹è¯•äºŒï¼šé…ç½®ä¸€æ¬¡æ€§ä¿®æ”¹çš„å‘½ä»¤ï¼›

åœ¨package.jsonä¸­é…ç½®ä¸€ä¸ªscriptsï¼š

```json
    "prettier": "prettier --write ."
```



## 1.3. ä½¿ç”¨ESLintæ£€æµ‹

1.åœ¨å‰é¢åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±é€‰æ‹©äº†ESLintï¼Œæ‰€ä»¥Vueä¼šé»˜è®¤å¸®åŠ©æˆ‘ä»¬é…ç½®éœ€è¦çš„ESLintç¯å¢ƒã€‚

2.VSCodeéœ€è¦å®‰è£…ESLintæ’ä»¶ï¼š

![image-20210722215933360](https://tva1.sinaimg.cn/large/008i3skNgy1gsq2oq26odj30pw05faaq.jpg)

3.è§£å†³eslintå’Œprettier**å†²çª**çš„é—®é¢˜ï¼š

åœ¨ç†æƒ³çš„çŠ¶æ€ä¸‹ï¼Œ`eslint`ä¸`prettier`åº”è¯¥å„å¸å…¶èŒã€‚`eslint`è´Ÿè´£æˆ‘ä»¬çš„ä»£ç è´¨é‡ï¼Œ`prettier`è´Ÿè´£æˆ‘ä»¬çš„ä»£ç æ ¼å¼ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¼šå‘ç°ï¼Œç”±äºæˆ‘ä»¬å¼€å¯äº†è‡ªåŠ¨åŒ–çš„`eslint`ä¿®å¤ä¸è‡ªåŠ¨åŒ–çš„æ ¹æ®`prettier`æ¥æ ¼å¼åŒ–ä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬å·²ä¿å­˜ä»£ç ï¼Œä¼šå‡ºç°å±å¹•é—ªä¸€èµ·ååˆæ¢å¤åˆ°äº†æŠ¥é”™çš„çŠ¶æ€ã€‚

è¿™å…¶ä¸­çš„æ ¹æœ¬åŸå› å°±æ˜¯`eslint`æœ‰éƒ¨åˆ†è§„åˆ™ä¸`prettier`å†²çªäº†ï¼Œæ‰€ä»¥ä¿å­˜çš„æ—¶å€™æ˜¾ç¤ºè¿è¡Œäº†`eslint`çš„ä¿®å¤å‘½ä»¤ï¼Œç„¶åå†è¿è¡Œ`prettier`æ ¼å¼åŒ–ï¼Œæ‰€ä»¥å°±ä¼šå‡ºç°å±å¹•é—ªä¸€ä¸‹ç„¶ååˆæ¢å¤åˆ°æŠ¥é”™çš„ç°è±¡ã€‚è¿™æ—¶å€™ä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å†²çªçš„è§„åˆ™ã€‚

æŸ¥é˜…èµ„æ–™ä¼šå‘ç°ï¼Œç¤¾åŒºå·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªéå¸¸æˆç†Ÿçš„æ–¹æ¡ˆï¼Œå³`eslint-config-prettier` + `eslint-plugin-prettier`ã€‚

å®‰è£…æ’ä»¶ï¼šï¼ˆvueåœ¨åˆ›å»ºé¡¹ç›®æ—¶ï¼Œå¦‚æœé€‰æ‹©prettierï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ’ä»¶ä¼šè‡ªåŠ¨å®‰è£…ï¼‰

```shell
npm i eslint-plugin-prettier eslint-config-prettier -D
```

**åœ¨ `.eslintrc.json`ä¸­`extends`çš„æœ€åæ·»åŠ ä¸€ä¸ªé…ç½®**

```diff
{ 
    extends: [
    'eslint:recommended',
    'plugin:vue/vue3-essential',
    'plugin:@typescript-eslint/recommended',
+    // æ–°å¢ï¼Œå¿…é¡»æ”¾åœ¨æœ€åé¢
+    'plugin:prettier/recommended' 
  ],
}
```



.eslintrc.jsæ–‡ä»¶å®Œæ•´é…ç½®å¦‚ä¸‹ï¼š

```json
  extends: [
    "plugin:vue/vue3-essential",
    "eslint:recommended",
    "@vue/typescript/recommended",
    "@vue/prettier",
    "@vue/prettier/@typescript-eslint",
    "plugin:prettier/recommended"
  ],
```



## 1.4. git Huskyå’Œeslint

> å¯¹äºä¸ä½¿ç”¨`vscode`çš„ï¼Œæˆ–è€…æ²¡æœ‰å®‰è£…`eslint`ã€`preitter`ä¸`stylelint`æ’ä»¶çš„åŒå­¦æ¥è¯´ï¼Œå°±ä¸èƒ½å®ç°åœ¨ä¿å­˜çš„æ—¶å€™è‡ªåŠ¨çš„å»ä¿®å¤ä¸å’Œæ ¼å¼åŒ–ä»£ç ã€‚
>
> è¿™æ ·æäº¤åˆ°`git`ä»“åº“çš„ä»£ç è¿˜æ˜¯ä¸ç¬¦åˆè¦æ±‚çš„ã€‚å› æ­¤éœ€è¦å¼•å…¥å¼ºåˆ¶çš„æ‰‹æ®µæ¥ä¿è¯æäº¤åˆ°`git`ä»“åº“çš„ä»£ç æ—¶ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚çš„ã€‚
>
> `husky`æ˜¯ä¸€ä¸ªç”¨æ¥ç®¡ç†`git hook`çš„å·¥å…·ï¼Œ`git hook`å³åœ¨æˆ‘ä»¬ä½¿ç”¨`git`æäº¤ä»£ç çš„è¿‡ç¨‹ä¸­ä¼šè§¦å‘çš„é’©å­ã€‚

è™½ç„¶æˆ‘ä»¬å·²ç»è¦æ±‚é¡¹ç›®ä½¿ç”¨eslintäº†ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯ç»„å‘˜æäº¤ä»£ç ä¹‹å‰éƒ½å°†eslintä¸­çš„é—®é¢˜è§£å†³æ‰äº†ï¼š

* ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸Œæœ›ä¿è¯ä»£ç ä»“åº“ä¸­çš„ä»£ç éƒ½æ˜¯ç¬¦åˆeslintè§„èŒƒçš„ï¼›

* é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ç»„å‘˜æ‰§è¡Œ `git commit ` å‘½ä»¤çš„æ—¶å€™å¯¹å…¶è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœä¸ç¬¦åˆeslintè§„èŒƒï¼Œé‚£ä¹ˆ**è‡ªåŠ¨**é€šè¿‡è§„èŒƒè¿›è¡Œä¿®å¤ï¼›

é‚£ä¹ˆå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿå¯ä»¥é€šè¿‡Huskyå·¥å…·ï¼š

* huskyæ˜¯ä¸€ä¸ªgit hookå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§¦å‘gitæäº¤çš„å„ä¸ªé˜¶æ®µï¼špre-commitã€commit-msgã€pre-push

å¦‚ä½•ä½¿ç”¨huskyå‘¢ï¼Ÿ

**è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåŠ¨é…ç½®å‘½ä»¤ï¼š**ç›´æ¥ä¸‹è½½å°±è¡Œ

```shell
npx husky-init && npm install
```

è¿™é‡Œä¼šåšä¸‰ä»¶äº‹ï¼š

1.å®‰è£…huskyç›¸å…³çš„ä¾èµ–ï¼š

![image-20210723112648927](https://tva1.sinaimg.cn/large/008i3skNgy1gsqq0o5jxmj30bb04qwen.jpg)

2.åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º `.husky` æ–‡ä»¶å¤¹ï¼š

```
npx huksy install
```



![image-20210723112719634](https://tva1.sinaimg.cn/large/008i3skNgy1gsqq16zo75j307703mt8m.jpg)

3.åœ¨package.jsonä¸­æ·»åŠ ä¸€ä¸ªè„šæœ¬ï¼š

![image-20210723112817691](https://tva1.sinaimg.cn/large/008i3skNgy1gsqq26phpxj30dj06fgm3.jpg)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å»å®Œæˆä¸€ä¸ªæ“ä½œï¼šåœ¨è¿›è¡Œcommitæ—¶ï¼Œæ‰§è¡Œlintè„šæœ¬ï¼š

![image-20210723112932943](https://tva1.sinaimg.cn/large/008i3skNgy1gsqq3hn229j30nf04z74q.jpg)





è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰§è¡Œgit commitçš„æ—¶å€™ä¼šè‡ªåŠ¨å¯¹ä»£ç è¿›è¡Œlintæ ¡éªŒã€‚



**æ³¨æ„ï¼š**

æ‰§è¡Œå‘½ä»¤æ—¶å‡ºé”™çš„æƒ…å†µï¼š

```js
E:\note\å‰ç«¯\ä»£ç \vue3_demo\vite_demo\vite_test>npx husky-init && npm install
npx: 2 å®‰è£…æˆåŠŸï¼Œç”¨æ—¶ 2.084 ç§’
husky-init updating package.json
  setting prepare script to command "husky install"
can't create hook, .husky directory doesn't exist (try running husky install)
```

å®‰è£…huskyæŠ¥é”™ï¼ˆé‡åˆ°çš„é—®é¢˜ï¼‰

```
husky - can't create hook, .husky directory doesn't exist (try running husky install)
ä¸èƒ½åˆ›å»ºé’©å­ï¼Œ.huskyç›®å½•ä¸å­˜åœ¨(å°è¯•è¿è¡ŒHusky install)
```

ä¸èƒ½åˆ›å»ºé’©å­ï¼Œ.huskyç›®å½•ä¸å­˜åœ¨(å°è¯•è¿è¡ŒHusky install)
**è§£å†³ï¼š**

é‡æ–°æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤

```
git init
npx husky-init
```



**æ³¨æ„ï¼š**

- ä¸Šè¿°å‘½ä»¤éœ€è¦åœ¨git bashä¸­æ‰§è¡Œï¼ï¼ï¼
- å¦åˆ™ä¼šæŠ¥é”™



## 1.5. git commitè§„èŒƒ

### 1.5.1. ä»£ç æäº¤é£æ ¼

é€šå¸¸æˆ‘ä»¬çš„git commitä¼šæŒ‰ç…§ç»Ÿä¸€çš„é£æ ¼æ¥æäº¤ï¼Œè¿™æ ·å¯ä»¥å¿«é€Ÿå®šä½æ¯æ¬¡æäº¤çš„å†…å®¹ï¼Œæ–¹ä¾¿ä¹‹åå¯¹ç‰ˆæœ¬è¿›è¡Œæ§åˆ¶ã€‚

![](https://tva1.sinaimg.cn/large/008i3skNgy1gsqw17gaqjj30to0cj3zp.jpg)

ä½†æ˜¯å¦‚æœæ¯æ¬¡æ‰‹åŠ¨æ¥ç¼–å†™è¿™äº›æ˜¯æ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·¥å…·ï¼šCommitizen

* Commitizen æ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬ç¼–å†™è§„èŒƒ commit message çš„å·¥å…·ï¼›

1.å®‰è£…Commitizen

```shell
npm install commitizen -D
```

2.å®‰è£…cz-conventional-changelogï¼Œå¹¶ä¸”åˆå§‹åŒ–cz-conventional-changelogï¼š

```shell
npx commitizen init cz-conventional-changelog --save-dev --save-exact
```

è¿™ä¸ªå‘½ä»¤ä¼šå¸®åŠ©æˆ‘ä»¬å®‰è£…cz-conventional-changelogï¼š

![image-20210723145249096](https://tva1.sinaimg.cn/large/008i3skNgy1gsqvz2odi4j30ek00zmx2.jpg)

å¹¶ä¸”åœ¨package.jsonä¸­è¿›è¡Œé…ç½®ï¼š

![](https://tva1.sinaimg.cn/large/008i3skNgy1gsqvzftay5j30iu04k74d.jpg)

**è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æäº¤ä»£ç éœ€è¦ä½¿ç”¨ `npx cz`ï¼šè€Œä¸æ˜¯ä½¿ç”¨ git commit -m "xxx"**

* ç¬¬ä¸€æ­¥æ˜¯é€‰æ‹©typeï¼Œæœ¬æ¬¡æ›´æ–°çš„ç±»å‹

| Type     | ä½œç”¨                                                         |
| -------- | ------------------------------------------------------------ |
| feat     | æ–°å¢ç‰¹æ€§ (feature)                                           |
| fix      | ä¿®å¤ Bug(bug fix)                                            |
| docs     | ä¿®æ”¹æ–‡æ¡£ (documentation)                                     |
| style    | ä»£ç æ ¼å¼ä¿®æ”¹(white-space, formatting, missing semi colons, etc) |
| refactor | ä»£ç é‡æ„(refactor)                                           |
| perf     | æ”¹å–„æ€§èƒ½(A code change that improves performance)            |
| test     | æµ‹è¯•(when adding missing tests)                              |
| build    | å˜æ›´é¡¹ç›®æ„å»ºæˆ–å¤–éƒ¨ä¾èµ–ï¼ˆä¾‹å¦‚ scopes: webpackã€gulpã€npm ç­‰ï¼‰ |
| ci       | æ›´æ”¹æŒç»­é›†æˆè½¯ä»¶çš„é…ç½®æ–‡ä»¶å’Œ package ä¸­çš„ scripts å‘½ä»¤ï¼Œä¾‹å¦‚ scopes: Travis, Circle ç­‰ |
| chore    | å˜æ›´æ„å»ºæµç¨‹æˆ–è¾…åŠ©å·¥å…·(æ¯”å¦‚æ›´æ”¹æµ‹è¯•ç¯å¢ƒ)                     |
| revert   | ä»£ç å›é€€                                                     |

* ç¬¬äºŒæ­¥é€‰æ‹©æœ¬æ¬¡ä¿®æ”¹çš„èŒƒå›´ï¼ˆä½œç”¨åŸŸï¼‰

![image-20210723150147510](https://tva1.sinaimg.cn/large/008i3skNgy1gsqw8ca15oj30r600wmx4.jpg)

* ç¬¬ä¸‰æ­¥é€‰æ‹©æäº¤çš„ä¿¡æ¯

![image-20210723150204780](https://tva1.sinaimg.cn/large/008i3skNgy1gsqw8mq3zlj60ni01hmx402.jpg)

* ç¬¬å››æ­¥æäº¤è¯¦ç»†çš„æè¿°ä¿¡æ¯ï¼šè¿™é‡Œç›´æ¥å›è½¦è·³è¿‡

![image-20210723150223287](https://tva1.sinaimg.cn/large/008i3skNgy1gsqw8y05bjj30kt01fjrb.jpg)

* ç¬¬äº”æ­¥æ˜¯å¦æ˜¯ä¸€æ¬¡é‡å¤§çš„æ›´æ”¹

![image-20210723150322122](https://tva1.sinaimg.cn/large/008i3skNgy1gsqw9z5vbij30bm00q744.jpg)

* ç¬¬å…­æ­¥æ˜¯å¦å½±å“æŸä¸ªopen issue

![image-20210723150407822](https://tva1.sinaimg.cn/large/008i3skNgy1gsqwar8xp1j30fq00ya9x.jpg)

æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨scriptsä¸­æ„å»ºä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œ czï¼š

![image-20210723150526211](https://tva1.sinaimg.cn/large/008i3skNgy1gsqwc4gtkxj30e207174t.jpg)



### 1.5.2. ä»£ç æäº¤éªŒè¯

å¦‚æœæˆ‘ä»¬æŒ‰ç…§czæ¥è§„èŒƒäº†æäº¤é£æ ¼ï¼Œä½†æ˜¯ä¾ç„¶æœ‰åŒäº‹é€šè¿‡ `git commit` æŒ‰ç…§ä¸è§„èŒƒçš„æ ¼å¼æäº¤åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ

* æˆ‘ä»¬å¯ä»¥é€šè¿‡commitlintæ¥é™åˆ¶æäº¤ï¼›

1.å®‰è£… @commitlint/config-conventional å’Œ @commitlint/cli

```shell
npm i @commitlint/config-conventional @commitlint/cli -D
```

2.åœ¨æ ¹ç›®å½•åˆ›å»ºcommitlint.config.jsæ–‡ä»¶ï¼Œé…ç½®commitlint

```js
module.exports = {
  extends: ['@commitlint/config-conventional']
}
```

3.ä½¿ç”¨huskyç”Ÿæˆcommit-msgæ–‡ä»¶ï¼ŒéªŒè¯æäº¤ä¿¡æ¯ï¼š(**å¯¹æäº¤ä¿¡æ¯è¿›è¡Œæ‹¦æˆª**)

```shell
npx husky add .husky/commit-msg "npx --no-install commitlint --edit $1"
```

è¿™é‡Œä½¿ç”¨å‘½ä»¤ä¸æˆåŠŸ

æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶ `commit-msg`ï¼šè¯¥æ–‡ä»¶ä¸`pre-commit`æ–‡ä»¶åŒçº§

```
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx --no-install commitlint --edit
```



æ­¤æ—¶æˆ‘ä»¬æµ‹è¯•ç”¨git commit æäº¤ï¼Œå¤±è´¥

![](./å›¾ç‰‡/commit.jpg)



æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç”¨`npx cz`æäº¤ï¼Œä½†æ˜¯è¯¥å‘½ä»¤ä¸å¤ªç†Ÿæ‚‰ï¼Œè¦æ”¹å

æˆ‘ä»¬åœ¨package.jsonä¸­æ–°å¢è„šæœ¬ï¼š`"commit": "cz"`

æ•´ä½“é…ç½®å¦‚ä¸‹ï¼š

```js
 "scripts": {
    "serve": "vue-cli-service serve",
    "build": "vue-cli-service build",
    "lint": "vue-cli-service lint",
    "prettier": "prettier --write .",
    "prepare": "husky install",
    "commit": "cz"
  },
```

ä»¥åæˆ‘ä»¬ä½¿ç”¨ `npm run commit` æ¥è¿›è¡Œæäº¤

å…·ä½“æäº¤æµç¨‹å¦‚ä¸‹ï¼š

- é¦–å…ˆè¦åœ¨git bushçš„å‘½ä»¤è¡Œçª—å£ä¸‹æ‰§è¡Œå‘½ä»¤ï¼ï¼ï¼
- ç„¶åæ‰§è¡Œ git add .
- æ‰§è¡Œ `npm run commit`
- æ¥ä¸‹æ¥çš„æ“ä½œå°±æ˜¯ä¸Šé¢çš„æ³¨é‡Šçš„æ“ä½œ 



### 1.5.3 æ‰©å±•â€”â€”è‡ªå®šä¹‰æäº¤è§„èŒƒ

```
npm i -D commitlint-config-cz  cz-customizable
```

å˜æ›´ **commitlint.config.js** è¿™é‡Œé‡‡ç”¨è‡ªå·±å®šä¹‰çš„è§„èŒƒ,å°†ä¼šè¦†ç›–ä¸Šé¢é‚£ä¸ª,æ‰€ä»¥ä¸Šé¢é‚£ä¸ªå¯ä»¥ä¸ç”¨å®‰è£…

![](./å›¾ç‰‡/1.webp)

å¢åŠ  .cz-config.js

```scss
  'use strict'
  module.exports = {
    types: [
      { value: 'âœ¨æ–°å¢', name: 'æ–°å¢:    æ–°çš„å†…å®¹' },
      { value: 'ğŸ›ä¿®å¤', name: 'ä¿®å¤:    ä¿®å¤ä¸€ä¸ªBug' },
      { value: 'ğŸ“æ–‡æ¡£', name: 'æ–‡æ¡£:    å˜æ›´çš„åªæœ‰æ–‡æ¡£' },
      { value: 'ğŸ’„æ ¼å¼', name: 'æ ¼å¼:    ç©ºæ ¼, åˆ†å·ç­‰æ ¼å¼ä¿®å¤' },
      { value: 'â™»ï¸é‡æ„', name: 'é‡æ„:    ä»£ç é‡æ„ï¼Œæ³¨æ„å’Œç‰¹æ€§ã€ä¿®å¤åŒºåˆ†å¼€' },
      { value: 'âš¡ï¸æ€§èƒ½', name: 'æ€§èƒ½:    æå‡æ€§èƒ½' },
      { value: 'âœ…æµ‹è¯•', name: 'æµ‹è¯•:    æ·»åŠ ä¸€ä¸ªæµ‹è¯•' },
      { value: 'ğŸ”§å·¥å…·', name: 'å·¥å…·:    å¼€å‘å·¥å…·å˜åŠ¨(æ„å»ºã€è„šæ‰‹æ¶å·¥å…·ç­‰)' },
      { value: 'âªå›æ»š', name: 'å›æ»š:    ä»£ç å›é€€' }
    ],
    scopes: [
      { name: 'leetcode' },
      { name: 'javascript' },
      { name: 'typescript' },
      { name: 'Vue' },
      { name: 'node' }
    ],
    // it needs to match the value for field type. Eg.: 'fix'
    /*  scopeOverrides: {
      fix: [
        {name: 'merge'},
        {name: 'style'},
        {name: 'e2eTest'},
        {name: 'unitTest'}
      ]
    },  */
    // override the messages, defaults are as follows
    messages: {
      type: 'é€‰æ‹©ä¸€ç§ä½ çš„æäº¤ç±»å‹:',
      scope: 'é€‰æ‹©ä¸€ä¸ªscope (å¯é€‰):',
      // used if allowCustomScopes is true
      customScope: 'Denote the SCOPE of this change:',
      subject: 'çŸ­è¯´æ˜:\n',
      body: 'é•¿è¯´æ˜ï¼Œä½¿ç”¨"|"æ¢è¡Œ(å¯é€‰)ï¼š\n',
      breaking: 'éå…¼å®¹æ€§è¯´æ˜ (å¯é€‰):\n',
      footer: 'å…³è”å…³é—­çš„issueï¼Œä¾‹å¦‚ï¼š#31, #34(å¯é€‰):\n',
      confirmCommit: 'ç¡®å®šæäº¤è¯´æ˜?(yes/no)'
    },
    allowCustomScopes: true,
    allowBreakingChanges: ['ç‰¹æ€§', 'ä¿®å¤'],
    // limit subject length
    subjectLimit: 100
  }
```

package.json ä¸­,å°†åŸæ¥commité…ç½®,å˜æ›´ä¸ºè‡ªå®šä¹‰é…ç½®

![](./å›¾ç‰‡/2.webp)

ç„¶åæäº¤ä¼šå˜æˆè¿™æ ·

![](./å›¾ç‰‡/3.webp)

## bugè§£å†³

```
Failed to load config â€œ@vue/prettierâ€œ to extend from
```

è¿™ç§æ˜¯ç‰ˆæœ¬é—®é¢˜ã€‚

è§£å†³æ–¹æ¡ˆ:
@vue/prettieræ”¹ä¸ºprettier
åŸå› è¿˜ä¸çŸ¥é“, @vue/prettieråœ¨@vue/ä¸‹æ²¡æ‰¾åˆ°

å‚è€ƒè§£å†³æ–¹æ¡ˆï¼šhttps://www.cnblogs.com/boji/p/15929707.html





ç›¸å…³æ–‡ç« ï¼š

[vue3+ts+viteé¡¹ç›®ä¸­ä½¿ç”¨eslint+prettier+stylelint+huskyæŒ‡å—](https://juejin.cn/post/7118294114734440455#heading-24)

[Eslint + Prettier + Husky + Commitlint+ Lint-staged è§„èŒƒå‰ç«¯å·¥ç¨‹ä»£ç è§„èŒƒ](https://juejin.cn/post/7038143752036155428#heading-5)